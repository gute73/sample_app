
var st_ConfigID='1';
st_BaseTrackURL = '//smartertrack.nextmeta.com:443/';
var st_LinkID='stlivechat0';
st_InitializeChat('13.1.6718.30659.8d62cd28c1bf7e0');var isSTChatInitialized=!1;document.addEventListener("DOMContentLoaded",function(){st_InitializeChat()}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return t<this.length?t|=0:t=this.length,this.substr(t-e.length,e.length)===e});var st_jsVersion,st_Widget={},safeNow=Date.now||function(){return(new Date).getTime()},safeThrottle=function(e,t,n){var s,a,i,l=null,o=0;n||(n={});var r=function(){o=!1===n.leading?0:safeNow(),l=null,i=e.apply(s,a),l||(s=a=null)};return function(){var d=safeNow();o||!1!==n.leading||(o=d);var u=t-(d-o);return s=this,a=arguments,u<=0||u>t?(l&&(clearTimeout(l),l=null),o=d,i=e.apply(s,a),l||(s=a=null)):l||!1===n.trailing||(l=setTimeout(r,u)),i}},safeDebounce=function(e,t,n){var s,a,i,l,o,r=function(){var d=safeNow()-l;d<t&&d>=0?s=setTimeout(r,t-d):(s=null,n||(o=e.apply(i,a),s||(i=a=null)))};return function(){i=this,a=arguments,l=safeNow();var d=n&&!s;return s||(s=setTimeout(r,t)),d&&(o=e.apply(i,a),i=a=null),o}};function st_focusControl(e){setTimeout(function(){e.setActive?e.setActive():$(e).focus&&$(e).focus()},50)}function st_InitializeChat(e){if(!isSTChatInitialized&&"undefined"!=typeof st_BaseTrackURL)if(isSTChatInitialized=!0,st_jsVersion=e||"","undefined"==typeof isPopup)if("undefined"==typeof $){var t=document.createElement("script");t.onload=function(){CheckForSignalR()},t.src=st_BaseTrackURL+"Scripts/jquery-1.6.4.min.js"+(""!==st_jsVersion?"?v="+st_jsVersion:""),document.getElementsByTagName("body")[0].appendChild(t)}else CheckForSignalR();else MakeClientChatWidgetHandler()}function CheckForSignalR(){if("function"!=typeof $.signalR){var e=document.createElement("script");e.onload=function(){CheckForHub()},e.src=st_BaseTrackURL+"Scripts/jquery.signalR-2.2.0.min.js"+(""!==st_jsVersion?"?v="+st_jsVersion:""),document.getElementsByTagName("body")[0].appendChild(e)}else CheckForHub()}function CheckForHub(){if("object"!=typeof $.connection.stClientChatHub){var e=document.createElement("script");e.onload=function(){CheckForCommon()},e.src=st_BaseTrackURL+"signalr/hubs",document.getElementsByTagName("body")[0].appendChild(e)}else CheckForCommon()}function CheckForCommon(){if("undefined"!=typeof ChatCommon&&ChatCommon)CheckForDropZone();else{var e=document.createElement("script");e.onload=function(){CheckForDropZone()},e.src=st_BaseTrackURL+"dist/js/optional/ChatCommon.js"+(""!==st_jsVersion?"?v="+st_jsVersion:""),document.getElementsByTagName("body")[0].appendChild(e)}}function CheckForDropZone(){if("function"!=typeof Dropzone){var e=document.createElement("link");e.href=st_BaseTrackURL+"dist/css/dropzone.css",e.type="text/css",e.rel="stylesheet",document.getElementsByTagName("body")[0].appendChild(e);var t=document.createElement("script");t.onload=function(){MakeClientChatWidgetHandler()},t.src=st_BaseTrackURL+"dist/js/specific/DropZone.js"+(""!==st_jsVersion?"?v="+st_jsVersion:""),document.getElementsByTagName("body")[0].appendChild(t)}else MakeClientChatWidgetHandler()}function MakeClientChatWidgetHandler(){String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return void 0!==e[n]?e[n]:t})});var e,t=2e3,n="<div class='st_Alert'>{0}</div>",s="3000",a=null,i=null==(e=C("siteuidut"))||""==e?"":e,l={get:function(e,t,n,s){try{$.ajax({context:this,crossDomain:!0,url:st_BaseTrackURL+e,type:s,dataType:"json",xhrFields:{withCredentials:!0},success:function(e){null!=n&&n(e)},data:t})}catch(e){console.error(e.message)}}},o="null",r="null";"undefined"!=typeof InfoGuid&&""!=InfoGuid&&(o=InfoGuid),"undefined"!=typeof st_ConfigID&&""!==st_ConfigID&&(r=st_ConfigID);var d,u,c,p=(d="ChatLinkStyles.ashx?config="+r+"&ispopup="+("undefined"!=typeof isPopup),(u=document.createElement("link")).href=st_BaseTrackURL+d,u.type="text/css",u.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(u),u.SetStyle=function(e){u.href=st_BaseTrackURL+e},u);function h(){null!=p.timeoutEvent&&(clearTimeout(p.timeoutEvent),p.timeoutEvent=null),null!=c&&f(c)}function f(e){if(null!=e){var d,u,c=!0,p=!1,h=!1,f={chooseDept:1,preChat:2,kbSearch:3,waitPage:4,duringChat:5,survey:6,offline:7,chatInvite:8},m=e;if(-1!=m.ClientChatID&&(c=!1),null!=m.departments)if(null!=(u="undefined"!=typeof st_LinkID?document.getElementById(st_LinkID):document.getElementById("Chat"))){var g=function(){var e="undefined"!=typeof isPopup?" st_ChatPopup":"",t=F("div","st_Widget"+m.WidgetPosition+e,"st_Widget");t.ShowingChatEnded=!1;try{var o=C("st_ChatWidgetStatus"),d=o.split("|");t.WidgetStatus=parseInt(d[0]),t.IsCollapsed=void 0===d[1]||1==d[1],t.IsPoppedOut=void 0!==d[2]&&1==d[2]}catch(e){t.WidgetStatus=f.chooseDept,t.IsCollapsed=!0}var u=function(){t.ShouldShowTab=m.IsOnline&&2==m.ConfigSettings._onlineDisplayAs||!m.IsOnline&&2==m.ConfigSettings._offlineDisplayAs;var e,n=F("div","st_HeaderBackground","st_HeaderBackground"),s=F("a"),a=F("div","st_HeaderIconHolder"),i=F("img","st_HeaderIcon");if(i.src=m.HeaderIcon,a.appendChild(i),n.appendChild(a),"undefined"==typeof isPopup){n.appendChild(s);var l=F("div","st_HeaderTitle","st_HeaderTitle");e=F("span","st_HeaderTitleText","st_HeaderTitleText"),l.appendChild(e),s.appendChild(l)}return n.SetTitle=function(t){null!=e&&(e.innerHTML=t)},n.ShowExpanded=function(){m.IsOnline&&1==m.ConfigSettings._onlineDisplayAs||!m.IsOnline&&1==m.ConfigSettings._offlineDisplayAs||(n.className=n.className.replace(" st_Collapse",""))},n.Collapse=function(){n.className=n.className.replace(" st_Collapse",""),(m.IsOnline&&1==m.ConfigSettings._onlineDisplayAs||!m.IsOnline&&1==m.ConfigSettings._offlineDisplayAs)&&(n.className=n.className+" st_Collapse")},n.SetData=function(a,i){n.className=n.className.replace(" st_Collapse",""),t.ShouldShowTab=m.IsOnline&&2==m.ConfigSettings._onlineDisplayAs||!m.IsOnline&&2==m.ConfigSettings._offlineDisplayAs,t.ShouldShowTab||(n.className=n.className+" st_Collapse"),null!=a.AnchorTitle&&(s.title=a.AnchorTitle),n.SetTitle(a.Title),n.style.background=a.HeaderColor,null!=e&&(e.className="st_HeaderTitleText "+W(a.HeaderColor,!0))},n.onclick=function(){t.IsCollapsed?t.ShowExpanded():t.Collapse()},n}(),g=new function(){var e,a=F("div","st_Expanded","st_Expanded"),o=W(m.ConfigSettings._bodyColor),d=W(m.ConfigSettings._bodyColor,!0);""!=m.ConfigSettings._bodyColor&&(a.style.backgroundColor=m.ConfigSettings._bodyColor);"undefined"==typeof isPopup&&(e=function(){var e=F("div","st_ToolBar","st_ToolBar"),n=F("button","st_ToolBarButton "+d,"st_btnCloseChat","X","",function(e){if(-1==m.ClientChatID||t.ShowingChatEnded)if(t.WidgetStatus==f.survey)l.get("api/Chat/ClearTakeSurveyCookie",null,null,"POST"),m.SurveyOffer="",t.ShowChatEnded(!1,t.WidgetStatus,!1);else{if(t.WidgetStatus==f.chatInvite)return t.Body.RejectInvite(),!1;k(),e.stopPropagation()}else{if(c)return void t.ShowChatEnded(!1,t.WidgetStatus,!0);M.Show(m.LblCloseChatConfirm)}return!1});e.appendChild(n);var s=F("button","st_ToolBarButton "+d,"st_btnPopup","<div class='st_btnPopupIcon "+d+"Border'></div>","",function(){return t.IsUploading?(M.Show(m.AbortYourUploadMsg,function(){t.Body.CancelUploads(),a(),M.style.display="none"}),!1):(a(),!1)});function a(){t.IsPoppedOut=!0,t.style.display="none";var e=window.open(st_BaseTrackURL+"Main/Chat/frmClientChat.aspx?config="+r,"LiveChat0","toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=0,width=360,height=420,target=blank");e&&(e.focus(),e.opener=window,i.click())}e.appendChild(s);var i=F("button","st_ToolBarButton "+d,"st_btnCollapse","<div class='st_btnCollapseIcon "+d+"Border'></div>","",function(){return setTimeout(t.Collapse,10),!1});return e.appendChild(i),e.ShowLowResloution=function(){s.click()},e}(),a.appendChild(e));var C={};function g(e){return null==C[e]&&_(e),null==C[e]?(_(f.chooseDept),C[f.chooseDept]):C[e]}function _(e){var r=null;switch(e){case f.chooseDept:r=function(){var e=F("div","st_PreChat st_flex-container scrollable","st_ChooseDept","","none"),t=F("div","st_ErrorBox","st_ChooseDeptError");e.appendChild(t);var n=F("h2","st_Header "+d,"st_ChooseDeptHeader",m.SelectADeptPretext);e.appendChild(n);var s=F("h2","st_Header "+d,"st_ChooseDeptHeader",m.SelectADeptTxt);e.appendChild(s);var a=F("div","st_Control","st_ChooseDeptControl");e.appendChild(a);var i=function(e){var t="<select id='st_DeptDropDown' class='st_FormControl DropDown'>";if(null!=e)for(var n in e)e.hasOwnProperty(n)&&(t+="<option class='st_ChooseDeptOption' value="+n+">"+e[n]+"</option>");return t+="</select>",$(t)[0]}(m.departments);return a.appendChild(i),i.onchange=function(){e.submitClick()},e.DropDown=i,e.AddToDropdown=function(e,t){i.appendChild($("<option class='st_ChooseDeptOption' value="+e+">"+t+"</option>")[0])},e.ClearDropdown=function(){i.options.length=0},e.Hide=function(){e.style.display="none"},e.Show=function(){e.style.display="",i.selectedIndex=0,st_focusControl(i)},e.submitClick=function(){var e=i.options[i.selectedIndex].value;0!=e&&P(e,t)},e}();break;case f.kbSearch:r=function(){var e=F("div","st_KBSearch st_flex-container","st_KBSearch",null,"none"),n=F("div","st_KBBody scrollable","st_KBBody");e.appendChild(n);var s=F("p","st_KBInner "+d,"st_KBInner",m.KbSearchMessage);n.appendChild(s);var i=F("div","st_KBResults","st_KBresults");n.appendChild(i);var l=F("div","st_Suggestions","st_Suggestions");i.appendChild(l);var r=F("input","st_SubmitBtn st_BtnPrimary","st_KBSubmitBtn");r.type="button",r.value=m.LblStartChat;var u=F("div","st_buttonWrapper","st_preSubmitWrapper");u.appendChild(r),r.onclick=function(){e.isForTicketSubmission?g(f.offline).submitClick(r):g(f.preChat).submitClick(r)};var c=F("input","st_BackBtn st_BtnSecondary","st_KBBackBtn");return c.type="button",c.value=m.LblBack,u.appendChild(c),e.appendChild(u),c.onclick=function(){e.isForTicketSubmission?(a.HideAll(f.offline),g(f.offline).Show(),t.WidgetStatus=f.offline,"undefined"==typeof isPopup&&N("st_ChatWidgetStatus",f.offline+"|"+(t.IsCollapsed?"1":"0")+"|"+(t.IsPoppedOut?"1":"0")),g(f.offline).FocusItem()):(a.ShowPage(f.preChat),g(f.preChat).FocusItem())},e.AddArticles=function(t,n){for(var s in l.innerHTML="",r.value=n?m.LblSubmitTicket:m.LblStartChat,e.isForTicketSubmission=n,t){var a=t[s],i=F("div","st_KBArticle "+o,"st_KBArticle");l.appendChild(i),i.innerHTML=a.Link;var d=F("span","st_Information "+o);d.innerHTML=a.Info,i.appendChild(d)}},e.Hide=function(){null!=r&&(r.clicked=!1),e.style.display="none",null!=r&&(r.style.display="none"),null!=c&&(c.style.display="none")},e.Show=function(){e.style.display="",null!=r&&(r.style.display=""),null!=c&&(c.style.display="")},e}();break;case f.duringChat:r=function(){var e=F("div","st_DuringChat st_flex-container","st_DuringChat",null,"none");e.HasSetFirstAgent=!1;var n=F("div","st_Error","st_Error"),i=new Array,r=!1;e.appendChild(n);var d,u=document.createElement("div");"undefined"!=typeof isPopup&&((d=F("input","st_BackBtn st_BtnSecondary","st_EndChatBtn")).type="button",d.value=m.LblEndChat,u.appendChild(d));null!=d&&(d.onclick=function(){return M.Show(m.LblCloseChatConfirm),!1});e.appendChild(u);var h=F("div","st_PostChatCustomMessage","st_PostChatCustomMessage","","none");e.appendChild(h);var C=function(){var n=F("div","st_MessagesContainer scrollable","st_messagesContainer"),s=new Array,i=!1;n.AnimateMessages=function(e){for(var t in e>3&&(e=0),i=!0,s)s[t].Animate(e);e+=1,s.length>0?setTimeout(function(){n.AnimateMessages(e)},500):i=!1};var l=F("div","st_MessagesContents","st_Messages");n.appendChild(l),n.AddMessage=function(e,a,l,o,r,d,u){if(t&&t.IsCollapsed&&!t.IsPoppedOut&&!u){var c=new Audio(m.ChatSoundURL);c.play(),y.className.indexOf("Animated")>0||(y.className=y.className+" st_LogoImageAnimated")}if(null!=a?(a=ChatCommon.linkify(a.replace(/\n/g,"<br />")),e=e.replace(/\n/g,"<br />")):e=ChatCommon.linkify(e.replace(/\n/g,"<br />")),!d){var p=null;for(var h in s)s[h].MessageID==r&&(p=s[h],s.splice(h,1));if(null!=p)return void p.SetText(e,a)}var f,C=F("div","st_Message","st_MessageContainer"+r),g=F("span","st_DisplayNameAgent","st_DisplayName",l+":"),v=F("span","st_DisplayNameAgent","st_DisplayName",m.LblYou+":");o?((f=F("span","st_ActualMessage  st_ActualMessage--alt","st_ActualMessage")).appendChild(v),f.innerHTML=f.innerHTML+"<br>"+e):((f=F("span","st_ActualMessage st_ActualMessage")).appendChild(g),f.innerHTML=f.innerHTML+"<br>"+e),C.IsUser=o,o&&(C.className=C.className+" st_UserMessage"),C.appendChild(f),this.AddMessageAndScrollDown(C);var S=F("span","st_ChatTranslation","st_ChatTranslation");null!=a&&(S.innerHTML=a),d||f.appendChild(S),d&&(C.Animate=function(e){f.innerHTML=f.innerHTML+".",e>2&&(f.innerHTML=o?".":": .")},C.MessageID=r,C.SetText=function(e,t){this.IsUser?(f.innerHTML="",v.innerHTML=m.LblYou+":",f.appendChild(v),f.innerHTML=f.innerHTML+"<br>"+e):f.innerHTML=": "+e,null!=t&&(S.innerHTML=t,f.appendChild(S)),n.scrollTop=n.scrollHeight},s.push(C),i||n.AnimateMessages(0))},n.AddSystemMessage=function(t){var n=F("div","st_AgentJoinOutter st_Message","st_AgentJoinOutter"),s=F("p","st_SystemMessage","st_SystemMessage",t);if(n.appendChild(s),t.indexOf("st_AgentJoin")>-1&&!e.HasSetFirstAgent){w.disabled=!1,st_focusControl(w),a.IsOutOfWaiting=!0;var i=document.getElementById("dropzone1");null!=i&&(i.style.pointerEvents=""),this.SetSecondMessage(t),e.HasSetFirstAgent=!0}else this.AddMessageAndScrollDown(n);return s.Hide=function(){n.style.display="none"},s.Show=function(){n.style.display=""},s},n.AddMessageAndScrollDown=function(e){l.appendChild(e),setTimeout(function(){n.scrollTop=n.scrollHeight},10)};var o=n.AddSystemMessage("");o.Hide();var r=n.AddSystemMessage("");return r.Hide(),n.ClearMessages=function(){l.innerHTML="",(o=n.AddSystemMessage("")).Hide(),(r=n.AddSystemMessage("")).Hide()},n.SetFirstMessage=function(e){o.innerHTML=e,o.Show()},n.SetSecondMessage=function(e){r.innerHTML=e,r.Show()},n.AppendToSecondMessage=function(e){r.appendChild(e),r.Show()},n}();e.appendChild(C);var _=F("div","st_TextBoxContainer","st_TextBoxContainer"),I=F("div","st_AgentTypeing","st_AgentTypingContainer",null,""),T=F("div","st_AgentTypeing "+o,"st_AgentStatus",null,"none");a.SetTypingMessage=function(e){T.innerHTML=e},e.ShowHideAgentStatus=function(e){T.style.display=e?"":"none"},I.appendChild(T),_.appendChild(I);var D=document.createElement("form"),w=F("textarea","st_FormControl","st_ReplyBox");w.placeholder=m.textAreaPlaceHolderText;var b,k=safeThrottle(function(){S.invoke("updateTyping",m.ClientChatID,""!==w.value,!1,w.value)},150);w.onkeydown=function(e){if(window.event?key=window.event.keyCode:key=e.which,!(13!=key||window.event&&window.event.shiftKey))return H(0,null,w.value),!1},w.onkeyup=function(e){if(!(13!=(window.event?window.event.keyCode:e.which)||window.event&&window.event.shiftKey))return S.invoke("updateTyping",m.ClientChatID,""!==w.value,!1,w.value),!1;c||k()},w.disabled=!0,setTimeout(function(){null!=m.UnsentMessageFromUser&&(w.value=m.UnsentMessageFromUser)},100),D.appendChild(w),_.appendChild(D),e.appendChild(_),m.AttachmentsAllowed&&(N=F("div","dropzone","dropzone1"),A=F("div","fallback"),B=F("div","st_ChatAttachments","st_chatAttachmentHolder"),(E=F("iframe","st_AttachmentFrame","st_AttachmentFrame")).style.border="0px",B.appendChild(E),E.src=st_BaseTrackURL+"/Chat/frmClientAttachment.aspx?chatid="+m.ClientChatID,A.appendChild(B),N.appendChild(A),b=N,w.className=w.className+" st_TextAreaAttachments",w.maxLength=s,e.appendChild(b),setTimeout(function(){var e,n=new Dropzone("#dropzone1",{url:st_BaseTrackURL+"/json-api.ashx?op=chat-customer/savefile?chatid="+m.ClientChatID,forceFallback:!1,autoProcessQueue:!1,addRemoveLinks:!0,dictDefaultMessage:m.LblDropFilesHere,maxFilesize:m.MaxUpload,dictFileTooBig:m.FileTooLargeMsg,dicCanceledUpload:m.CanceledUploadMsg});setTimeout(function(){if(!a.IsOutOfWaiting){var e=document.getElementById("dropzone1");null!=e&&(e.style.pointerEvents="none")}},10),a.CancelUploads=function(){t.IsUploading=!1,n.removeAllFiles(!0)},a.ChangeChatID=function(e){n.options.url=st_BaseTrackURL+"/json-api.ashx?op=chat-customer/savefile?chatid="+e};var s=0;window.Dropzone.isBrowserSupported()&&n.on("error",function(e,t){message={MessageID:0,Body:t,Language:m.AutoTranslateLanguage,UserID:m.UserID},H(1,message,t)}),n.on("addedfile",function(a){w.disabled?n.removeFile(a):(t.IsUploading=!0,s++,null!=e&&(n.removeFile(e),e=null),e=a)}),n.on("complete",function(t){null!=e&&(n.removeFile(e),e=null)}),n.on("removedfile",function(n){w.disabled||(t.IsUploading=!1,0==--s&&(e=null))})},100));var N,A,B,E;function H(e,t,n){if(r&&0==e){if(""==n.trim()||""==n.replace(/(?:\r\n|\r|\n)/g,""))return;var s={MessageID:a(),Body:n,Language:m.AutoTranslateLanguage,UserID:m.UserID};return i.push(s),void C.AddMessage(".","",m.UserName,!0,s.MessageID,!0)}if(0==e){if(""==n.trim()||""==n.trim().replace(/(?:\r\n|\r|\n)/g,""))return;t={MessageID:a(),Body:n,Language:m.AutoTranslateLanguage,UserID:m.UserID},C.AddMessage(".","",m.UserName,!0,t.MessageID,!0)}function a(){var e=m.InterfaceGuid+"_"+m.InterfaceMsgID;return m.InterfaceMsgID++,e}S.invoke("send",m.ClientChatID,t.Body,t.MessageID,!1,1024*m.MaxUpload).done(function(e){r=!1,i.length>0&&(H(0,i[0],n),i.splice(0,1))}).fail(function(s){++e<3?setTimeout(function(){H(e,t,n)},1e3):C.AddMessage(m.LblMsgFailed,"",m.UserName,!0,t.MessageID,!1)}),0==e&&(w.value="",setTimeout(function(){w.value=""},1))}return e.AppendToSecondMessage=function(e){C.AppendToSecondMessage(e)},e.ShowHideButtons=function(e){e?null!=d&&(d.style.display=""):null!=d&&(d.style.display="none")},e.AddSystemMessage=function(e){C.AddSystemMessage(e)},e.AddMessage=function(e,t,n,s,a,i){C.AddMessage(e,t,n,s,a,!1,i)},e.AddEmailTranscriptOption=function(){if(_.style.display="none",C.className=C.className+" st_MessagesTranscript",!e.createdEmail){var t;e.createdEmail=!0;var s,a=F("div","st_ChatEmailTranscript","st_ChatEmailTranscript");a.style.padding="10px",(s=F("input","st_EmailInput st_FormControl","st_EmailInput")).placeholder=m.LblEmailAddress,a.appendChild(s),(t=F("input","st_SubmitBtn st_TranscriptSubmitBtn st_BtnPrimary","st_TranscriptSubmitBtn")).type="submit",t.value=m.LblEmailTranscript,a.appendChild(t),e.appendChild(a),t.onclick=function(){return l.get("api/Chat/EmailTranscript/"+m.ClientChatID,{"":s.value},function(e){""!=e&&(n.innerHTML=e),e.indexOf(m.EmailSuccess)>0&&(s.value="")},"POST"),!1}}},e.RemoveEmailTranscriptOption=function(){if(C.className=C.className.replace(" st_MessagesTranscript",""),e.createdEmail=!1,"undefined"==typeof TxtBoxTranscript){_.style.display="";var t=document.getElementById("st_ChatEmailTranscript");t.parentElement.removeChild(t)}else TxtBoxTranscript.style.display="none",EmailTranscriptBtn.style.display="none"},e.ShowChatEnded=function(e,t,n){D.style.display="none",this.hasSMTP=t,this.ShowHideButtons(!1),C.SetFirstMessage(n),null!=e&&""!=e&&(h.innerHTML=e,h.style.display=""),t&&g(f.duringChat).AddEmailTranscriptOption(),null!=b&&(b.style.display="none")},e.HideChatEnded=function(){n.innerHTML="",D.style.display="",this.ShowHideButtons(!0),C.SetFirstMessage(""),h.innerHTML="",h.style.display="none",this.hasSMTP&&this.RemoveEmailTranscriptOption(),null!=b&&(b.style.display=""),t.WidgetStatus=f.duringChat,"function"==typeof sizeWindow&&sizeWindow()},e.Hide=function(){e.style.display="none",this.ShowHideButtons(!1)},e.Show=function(){if(p||-1===m.ClientChatID||c)e.style.display="",this.ShowHideButtons(!0),st_focusControl(w),setTimeout(function(){C.scrollTop=C.scrollHeight},10);else{function n(){e.ClearMessages(),L(function(){e.Show()})}v.state===$.signalR.connectionState.disconnected?(v.url=st_BaseTrackURL+(st_BaseTrackURL.endsWith("/")?"signalr":"/signalr"),v.start().done(function(){n()})):n()}t.WidgetStatus=f.duringChat,"function"==typeof sizeWindow&&sizeWindow(),st_focusControl(w)},e.ClearMessages=function(){C.ClearMessages(),e.HasSetFirstAgent=!1},e}();break;case f.preChat:r=function(){var e,o=document.getElementById("st_PreChat"),r=[];null==o?o=F("div","st_PreChat st_flex-container","st_PreChat","","none"):o.innerHTML="";var u=F("div","st_PreChatErrorBox","st_PreChatErrorBox");o.appendChild(u);var c="";null!=m.ChosenDepartment&&(c=m.ChosenDepartment.PreCustomMessage);var p=F("span","st_PreChatCustomMessage "+d,"st_PreChatCustomMessage",c);o.appendChild(p),null==e&&null!=m.ChosenDepartment&&(e=m.ChosenDepartment.CustomFields);var h=F("div","st_CustomFields scrollable","st_CustomFields",null,"");o.appendChild(h);var C=F("div","st_FormGroup","st_txtBoxQuestionOutter"),g=F("textarea","st_FormControl","st_txtBoxQuestion");g.maxLength=s,C.appendChild(g),g.onkeydown=_,g.placeholder=m.LabelForQuestion+"*",g.rows=4;var v,S=F("div","st_buttonWrapper","st_preSubmitWrapper");if(v=F("input","st_SubmitBtn st_BtnPrimary"),S.appendChild(v),v.type="button",v.value=m.LblSubmit,o.appendChild(S),v.onclick=function(){return o.submitClick(v)},null!=m.departments&&Object.keys(m.departments).length>2){var y;(y=F("input","st_BackBtn st_BtnSecondary","st_PreBackBtn")).type="button",y.value=m.LblBack,S.appendChild(y),o.appendChild(S),y.onclick=function(){a.ShowPage(f.chooseDept)}}function _(){null!=o.IsTypedEvent&&(clearTimeout(o.IsTypedEvent),o.IsTypedEvent=null),o.IsTypedEvent=setTimeout(function(){l.get("api/Chat/AutoSavePreChatCF",{"":a.GetCustomFieldsString(f.preChat,g.value)},function(e){},"POST")},1e3)}return o.Hide=function(){o.style.display="none",null!=v&&(v.clicked=!1,v.style.display="none"),null!=y&&(y.style.display="none")},o.Show=function(){var e=$(h).find("div").first().find(":first-child");if(e.length&&st_focusControl(e[0]),t.SelectKbSearch)return t.SelectKbSearch=!1,void v.click();u.innerHTML="",o.style.display="",null!=v&&(v.style.display="",v.disabled=!1),null!=y&&(y.style.display="")},o.FocusItem=function(){var e=!1;window.setTimeout(function(){for(var t=o.GetCustomFields(),n=0;n<t.length;++n)if(""==t[n].GetValue()){t[n].children[0].focus(),e=!0;break}0==e&&g.focus()},0)},o.SetCustomMessage=function(e){p.innerHTML=e},o.SetCustomFields=function(e){h.innerHTML="",C.innerHTML="",r.length=0;var t=JSON.parse(m.SavedCustomPreChatFields);$.each(e,function(e,n){r.push(I(n,h,u,t,_))}),g.value="",g.className=g.className.replace(" Error",""),null!=t&&null!=t.TB&&(g.value=t.TB),C.appendChild(g),h.appendChild(C)},o.GetCustomFields=function(){return r},o.SetCustomFields(e),o.submitClick=function(e){if(!m.IsOnline&&-1!=m.ClientChatID)return a.ShowPage(f.offline),!1;u.innerHTML="";var s=a.GetCustomFields(f.preChat),r=g.value;if(""==r.trim()||null==r)return g.className=g.className+" Error",null!=s&&(u.innerHTML=n.format(m.ErrorRequiredSurvey)),!1;if(g.className=g.className.replace(" Error",""),null==s)return!1;g.disabled=!0,null!=e&&(e.disabled=!0);var d={ChatID:m.ClientChatID,InfoGuid:m.InterfaceGuid,LastEventID:m.LastEventID,UserLanguage:m.AutoTranslateLanguage,UnsentMessageStandard:r,DepartmentID:m.ChosenDepartment.DepartmentID,Status:t.WidgetStatus,CustomFields:s,VisitorGuid:i};return l.get("api/Chat/StartChat",d,function(t){if(null==t&&a.ShowPage(f.offline),t.length>0&&"Error"==t[0].ActionCode&&(u.innerHTML=n.format(t[0].MsgBody)),t.length>0)for(var s=o.GetCustomFields(),i=0;i<s.length;++i)s[i].ID==t[0].MsgID&&(s[i].firstElementChild.className=s[i].firstElementChild.className+" Error");A(t,!0),null!=e&&(e.disabled=!1),g.disabled=!1},"POST"),!1},o.GetErrorBox=function(){return u},o}();break;case f.waitPage:r=function(){var e=F("div","st_Wait","st_ChatWaitPage",null,"none"),t=F("div","st_WaitHeader","st_HeaderWrapperWait");e.appendChild(t);var n="";null!=m.ChosenDepartment&&(n=m.ChosenDepartment.WaitMessage);var s=F("span","st_WaitInfoMsg","st_WaitInfoMsg",n);return e.appendChild(s),e.SetWaitInfoMsg=function(e){s.innerHTML=e},e.ChangeHeaderText=function(e){t.innerHTML=e},e.Hide=function(){e.style.display="none"},e.Show=function(){e.style.display="";var t=g(f.duringChat);t.AppendToSecondMessage(e),t.Show()},e}();break;case f.survey:r=function(){var e=F("div","st_flex-container","st_Survey",null,"none"),n=F("div","st_ErrorBox","st_PreChatErrorBox");e.appendChild(n);var s=F("div","st_SurveyPostChatCustomMessage "+d,"st_SurveyWelcomeText",null,"none");e.appendChild(s);var i=F("div","st_QuestionHolder scrollable","st_QuestionHolder");e.appendChild(i),e.AddQuestions=function(e,t){i.innerHTML="",s.innerHTML=t,null!=s.innerHTML&&""!=s.innerHTML?s.style.display="":s.style.display="none";var a=[],l=m.SurveyOffer;for(var o in e){var r=c(e[o],l);a.push(r),i.appendChild(r)}i.scrollTop=0,this.GetAnswers=function(){var e=[],t=!1;for(var s in a){var i=a[s],l=i.GetAnswer();i.CheckIsValid()?(i.RemoveClass(" Error"),e.push(l)):(i.AddClass(" Error"),t=!0)}return t?(n.innerHTML="<div class='st_Alert'>{0}</div>".format(m.ErrorRequiredSurvey),null):e}};var r=F("input","st_SubmitBtn st_BtnPrimary","st_SurveySubmitBtn");r.type="button",r.value=m.LblSubmit;var u=F("div","st_buttonWrapper","st_surveyButtonWrapper");u.appendChild(r),e.appendChild(u),r.onclick=function(){var n=m.SurveyOffer,s=e.GetAnswers();if(null!=n&&""!=n&&null!=s)l.get("api/Chat/SubmitSurvey",{"":s},function(){},"POST");else if(null==s)return;a.ShowChatEnded(!1,t.WidgetStatus,!1,!0)},e.Hide=function(){e.style.display="none",r.style.display="none"},e.Show=function(){n.innerHTML="",e.style.display="",r.style.display=""},m.SurveyQuestions.length>0&&e.AddQuestions(m.SurveyQuestions,m.ChosenDepartment.SurveyWelcomeTxt);function c(e,t){var n=F("div","st_SurveyQuestion","st_SurveyQuestion"+e.QuestionID),s=e.Question;if(e.IsRequired)var s=s+"*";switch(n.AddClass=function(e){n.Element.className=n.Element.className.replace(e,""),n.Element.className=n.Element.className+e},n.RemoveClass=function(e){n.Element.className=n.Element.className.replace(e,"")},e.Type){case 1:var a=F("input","st_FormControl","st_ShortText"+e.QuestionID);a.type="text",a.size="50",a.placeholder=s,n.appendChild(a),n.CheckIsValid=function(){return!e.IsRequired||null!=a.value&&""!=a.value},n.GetAnswer=function(){var n={SurveyOfferedID:t,SurveyQuestionID:e.QuestionID,TextAnswerValue:a.value,QuestionAsAsked:e.Question};return n},n.Element=a;break;case 2:var i=F("textarea","st_FormControl","st_LongText"+e.QuestionID);i.rows=3,i.cols=40,i.placeholder=s,n.appendChild(i),n.CheckIsValid=function(){return!e.IsRequired||null!=i.value&&""!=i.value},n.GetAnswer=function(){var n={SurveyOfferedID:t,SurveyQuestionID:e.QuestionID,TextAnswerValue:i.value,QuestionAsAsked:e.Question};return n},n.Element=i;break;case 3:var l=F("div","st_SurveyQuestionLbl "+d,"st_SurveyQuestionLbl"+e.QuestionID,s);n.appendChild(l),1==e.RenderOption?T(n,e,"radio",!0):I(n,e);break;case 4:var l=F("div","st_SurveyQuestionLbl "+d,"st_SurveyQuestionLbl"+e.QuestionID,s);n.appendChild(l),T(n,e,"checkbox",!1);break;case 5:var l=F("div","st_SurveyQuestionLbl "+d,"st_SurveyQuestionLbl"+e.QuestionID,s);n.appendChild(l),1==e.RenderOption?T(n,e,"radio",!0):I(n,e);break;case 6:n.Element=n;var l=F("div","st_SurveyQuestionLbl "+d,"st_SurveyQuestionLbl"+e.QuestionID,s);n.appendChild(l);var r=e.Answers[0]._answerText.split("-"),u=F("span","st_RatingOutterSpan","st_RatingOutterSpan"+e.QuestionID);n.appendChild(u);var c=F("table","st_SurveyTable","st_SurveyTable"+e.QuestionID);u.appendChild(c);var p=F("tablebody","st_SurveyTableBody","st_SurveyTableBody"+e.QuestionID);c.appendChild(p);var h=[],f=F("tr","st_SurveyTableRow2"+e.QuestionID);p.appendChild(f);for(var C=0;C<10;C++){var g=_("input","st_RadioButton",null,"radio",C+1,null,h),v=F("div","st_RadioButtonUnChecked");h[h.length-1].styledButton=v,g.appendChild(v),f.appendChild(g)}var S,y=F("tr","st_SurveyTableRow","st_SurveyTableRow1"+e.QuestionID);for(var C in p.appendChild(y),y.appendChild(_("span","st_Rating "+o,r[0],null,null,9)),y.appendChild(_("span","st_Rating "+o,r[1])),h)h[C].UnCheck=function(){this.checked=!1,this.styledButton.className=this.styledButton.className.replace(" st_RadioButtonChecked",""),this.styledButton.className=this.styledButton.className+" st_RadioButtonUnChecked"},h[C].onchange=function(){null!=S&&S.UnCheck(),this.checked=!0,S=this,this.styledButton.className=this.styledButton.className.replace(" st_RadioButtonUnChecked",""),this.styledButton.className=this.styledButton.className+" st_RadioButtonChecked"};n.CheckIsValid=function(){return!e.IsRequired||null!=S},n.GetAnswer=function(){var n=null;null!=S&&(n=S.value);var s={SurveyOfferedID:t,SurveyQuestionID:e.QuestionID,NumericAnswerValue:n,MaxQuestionValueAsAsked:r[1],QuestionAsAsked:e.Question,WeightAsAsked:e.Weight};return s}}function _(e,t,n,s,a,i,l){var o=F("td","st_SurveyColumn"),r=F(e,t,null,n);return null!=s&&(r.type=s),null!=a&&(r.value=a),null!=i&&(o.colSpan=i),o.appendChild(r),null!=l&&l.push(r),r.onclick=function(){r.onchange()},o}function I(e,t){for(var n="<select class='st_FormControl DropDown' id='st_SurveyDropdown"+t.QuestionID+"'>",s=0;s<t.Answers.length;s++){var a=t.Answers[s];n+="<option class='st_SurveyDdOption'  "+o+" value="+a._answerValue+">"+a._answerText+"</option>"}n+="</select>",n=$(n)[0],e.appendChild(n),e.Element=n,e.CheckIsValid=function(){return!t.IsRequired||0!=n.selectedIndex},e.GetAnswer=function(){var e={SurveyOfferedID:m.SurveyOffer,SurveyQuestionID:t.QuestionID,NumericAnswerValue:n.options[n.selectedIndex].value,TextAnswerValue:n.options[n.selectedIndex].innerHTML,MaxQuestionValueAsAsked:t.MaxValue,QuestionAsAsked:t.Question,WeightAsAsked:t.Weight};return e}}function T(e,t,n,s){e.Element=e;var a=F("div","st_RadioButtons","st_RadioButtons"+t.QuestionID);e.appendChild(a);var i=F("span","st_RadioSpan","st_RadioSpan"+t.QuestionID);a.appendChild(i);for(var l,o=[],r=0;r<t.Answers.length;r++){var d=t.Answers[r],u=D(i,n,d._answerValue,d._answerText);s?(u.UnCheck=function(){this.checked=!1,this.styledInput.className=this.styledInput.className.replace("st_InputStyledChecked",""),this.styledInput.className="st_InputStyledUnChecked"+this.styledInput.className},u.onchange=function(){null!=l&&l.UnCheck(),this.checked=!0,this.styledInput.className=this.styledInput.className.replace("st_InputStyledUnChecked",""),this.styledInput.className="st_InputStyledChecked"+this.styledInput.className,l=this}):u.onchange=function(){this.checked?(this.styledInput.className=this.styledInput.className.replace("st_InputStyledUnChecked",""),this.styledInput.className="st_InputStyledChecked"+this.styledInput.className):(this.styledInput.className=this.styledInput.className.replace("st_InputStyledChecked",""),this.styledInput.className="st_InputStyledUnChecked"+this.styledInput.className)},o.push(u)}s?(e.CheckIsValid=function(){return!t.IsRequired||null!=l},e.GetAnswer=function(){var e=null,n="";null!=l&&(e=l.value,n=l.textContent);var s={SurveyOfferedID:m.SurveyOffer,SurveyQuestionID:t.QuestionID,NumericAnswerValue:e,TextAnswerValue:n,MaxQuestionValueAsAsked:t.MaxValue,QuestionAsAsked:t.Question,WeightAsAsked:t.Weight};return s}):(e.CheckIsValid=function(){if(!t.IsRequired)return!0;for(var e=0;e<o.length;e++){var n=o[e];if(n.checked)return!0}return!1},e.GetAnswer=function(){for(var e=!0,n={},s=0;s<o.length;s++){var a=o[s];a.checked&&(e?(n={SurveyOfferedID:m.SurveyOffer,SurveyQuestionID:t.QuestionID,NumericAnswerValue:a.value,TextAnswerValue:a.textContent,QuestionAsAsked:t.Question},e=!1):n.TextAnswerValue+=", "+a.textContent)}return n})}function D(e,t,n,s){var a=F("input","st_Input"+t);a.type=t,a.value=n,a.textContent=s,e.appendChild(a);var i=F("div","st_InputStyledUnChecked"+t);a.styledInput=i,e.appendChild(i);var l=F("label",o+" st_Label"+t,"",s);return e.appendChild(l),e.appendChild($("<br>")[0]),a}return n}return e}();break;case f.offline:r=function(){var e=F("div","st_Offline st_flex-container","st_Offline",null,"none"),s=[],i=F("div","st_ErrorBox","st_PreChatErrorBoxOffline");e.appendChild(i);var o=F("span","st_PreChatCustomMessage "+d,"st_CustomOfflineMsg","");e.appendChild(o);var r=F("div","st_CustomFields scrollable","st_CustomFieldsOffline",null,"");e.appendChild(r);var u,c=F("div","st_buttonWrapper","st_offlineButtonWrapper"),p=F("input","st_SubmitBtn st_BtnPrimary","st_SubmitTicketBtn");p.type="button",p.value=m.LblSubmit,p.style.display="",c.appendChild(p),p.onclick=function(){e.submitClick()},null!=m.departments&&Object.keys(m.departments).length>2&&((u=F("input","st_BackBtn st_BtnSecondary","st_OffBackBtn")).type="button",u.value=m.LblBack,c.appendChild(u),u.onclick=function(){a.ShowPage(f.chooseDept)});function h(){null!=e.IsTypedEvent&&(clearTimeout(e.IsTypedEvent),e.IsTypedEvent=null),e.IsTypedEvent=setTimeout(function(){l.get("api/Chat/AutoSaveTicketCF",{"":a.GetCustomFieldsString(f.offline)},function(e){},"POST")},1e3)}return e.appendChild(c),e.GetErrorBox=function(){return i},e.submitClick=function(){if(!e.isMakingCall){var n=a.GetCustomFields(f.offline);if(null!=n){var s={ChatID:m.ClientChatID,DepartmentID:m.ChosenDepartment.DepartmentID,CustomFields:n,Status:t.WidgetStatus};e.isMakingCall=!0,l.get("api/Chat/SubmitTicket",s,function(t){if(A(t,!1),t.length>0)for(var n=e.GetCustomFields(),s=0;s<n.length;++s)n[s].ID==t[0].MsgID&&(n[s].firstElementChild.className=n[s].firstElementChild.className+" Error");e.isMakingCall=!1},"POST")}}},a.ShowTicketSubmitConfirmation=function(n,s){e.ShowTicketSubmitConfirmation(n,s),g(f.kbSearch).Hide(),e.style.display="",t.WidgetStatus=f.offline},e.AddCustomFields=function(e,t){o.innerHTML=t,s.length=0,r.innerHTML="",p.style.display="",null!=u&&(u.style.display="none");var n=JSON.parse(m.SavedCustomTicketFields);for(var a in e)s.push(I(e[a],r,i,n,h))},e.ShowNotAvailableMessage=function(e){o.innerHTML=e,r.innerHTML="",p.style.display="none",null!=u&&(u.style.display="")},e.GetCustomFields=function(){return s},e.Hide=function(t){t!=f.offline&&(e.style.display="none",p.value=m.LblSendMsg,null!=u&&(u.style.display="none"))},e.Show=function(){if(t.SelectKbSearch)return t.SelectKbSearch=!1,void p.click();i.innerHTML="",e.style.display="",null!=u&&null!=m.departments&&Object.keys(m.departments).length>2&&(u.style.display=""),p.value=m.LblSubmit},e.FocusItem=function(){window.setTimeout(function(){s.length>0&&s[0].firstElementChild.focus()},0)},e.ShowTicketSubmitConfirmation=function(e,s){null==s?(o.innerHTML=e,null!=u&&(u.style.display="none"),p.style.display="none",r.innerHTML="",t.WidgetStatus=f.chooseDept):i.innerHTML=n.format(s)},e}();break;case f.chatInvite:r=function(){var e=F("div","st_ChatInvite st_flex-container","st_ChatInvite",null,"none"),s=F("span","st_ChatInviteCustomMsg "+d,"st_PreChatCustomMessage");e.appendChild(s);var o=F("div","st_TextBoxContainer");e.appendChild(o),a.RejectInvite=function(){l.get("api/Chat/RejectInvite/"+i,null,function(e){},"POST"),null!=e.TimeoutEvent&&clearTimeout(e.TimeoutEvent),u()};var r=F("textarea","st_FormControl","st_ChatInviteTextBox");function u(){a.ShowPage(a.ChatInvite.PrevStatus),a.ChatInvite.WasCollapsed&&t.Collapse(),a.ChatInvite=null}return o.appendChild(r),r.rows="4",r.focus(),r.onkeydown=function(s){if(!(13!=(window.event?window.event.keyCode:s.which)||window.event&&window.event.shiftKey)){r.disabled=!0,null!=e.TimeoutEvent&&clearTimeout(e.TimeoutEvent);var o={ChatID:-1,InfoGuid:m.InterfaceGuid,LastEventID:-1,UserLanguage:m.AutoTranslateLanguage,UnsentMessageStandard:r.value,DepartmentID:a.ChatInvite.DepartmentID,GroupID:a.ChatInvite.GroupID,Status:t.WidgetStatus,CustomFields:null,VisitorGuid:i};P(a.ChatInvite.DepartmentID,null,!0),l.get("api/Chat/StartChat",o,function(e){a.ClearMessages(),m.LastAgentID=-1,null==e&&a.ShowPage(f.offline),e.length>0&&"Error"==e[0].ActionCode&&(errorBox.innerHTML=n.format(e[0].MsgBody)),A(e,!0),h&&a.ShowLowResloution()},"POST"),a.ChatInvite=null}},a.SetInviteData=function(t,n,a){r.disabled=!1,s.innerHTML=t,r.placeholder=n,null!=e.TimeoutEvent&&clearTimeout(e.TimeoutEvent),e.TimeoutEvent=setTimeout(function(){l.get("api/Chat/IgnoredInvite/"+i,null,function(e){},"POST"),u()},a)},e.Hide=function(){e.style.display="none"},e.Show=function(){t.ShowingChatEnded&&t.HideChatEnded(),e.style.display=""},e}()}null!=r&&(C[e]=r,a.appendChild(r)),$(".scrollable").bind("mousewheel DOMMouseScroll",function(e){var t=e.originalEvent,n=t.wheelDelta||-t.detail;this.scrollTop+=30*(n<0?1:-1),e.preventDefault()})}function I(e,t,s,a,i){var l=F("div","st_FormGroup"),o=e.DisplayName;e.IsRequired&&(o+="*"),l.onkeydown=function(e){13==e.which&&(e.stopPropagation(),e.preventDefault())},l.ID=e.ID,l.SpecialMapping=e.SpecialMapping,l.DisplayName=e.DisplayName,l.GetIndex=function(){return 1};var r=null;switch(null!=a&&null!=a[l.ID]&&""!=a[l.ID]&&(r=a[l.ID]),e.Type){case 2:var d=F("textarea","st_FormControl","st_field"+e.ID+"ctrl2");d.onkeydown=function(){i()},d.placeholder=o,d.rows=2,l.appendChild(d),d.value=e.DefaultValue,null!=r&&(d.value=r),l.GetValue=function(){return null==d.value?"":d.value},t.appendChild(l);break;case 3:if(e.DefaultValue=e.DisplayName)for(var u=e.Values.length-1;u>=0;u--){var c=e.Values[u];c===e.DisplayName&&e.Values.splice(u,1)}var p=F("select","st_FormControl DropDown","st_field"+e.ID+"ctrl2"),h=!0;for(var c in e.Values)p.appendChild($("<option class='st_CFOption' value='"+e.Values[c]+"' >"+e.Values[c]+(h&&e.IsRequired?"*":"")+"</option>")[0]),h=!1;p.onfocus=function(){p.className=p.className.replace(" st_Black","")},p.onblur=function(){p.className=p.className.replace(" st_Black",""),0==p.selectedIndex&&(p.className=p.className+" st_Black")},p.onchange=function(){p.className=p.className.replace(" st_Black",""),0==p.selectedIndex&&(p.className=p.className+" st_Black"),i()},g(p,null!=r?r:e.DefaultValue),0==p.selectedIndex&&(p.className=p.className+" st_Black"),l.appendChild(p),l.GetValue=function(){return p.options[p.selectedIndex].value},l.GetIndex=function(){return p.selectedIndex},t.appendChild(l);break;case 4:var d=F("input","st_FormControl","st_field"+e.ID+"ctrl3");d.onkeydown=function(){i()},l.appendChild(d),d.value=l.DefaultValue;var f=r.split(";");null!=r&&f.length>0&&(d.value=f[0]);var C=F("div","st_FormGroup","st_InnerField"+e.ID),p=F("select","st_FormControl DropDown","st_field"+e.ID+"ctrl2");for(var c in e.Values)p.appendChild($("<option class='st_CFOption' value='"+e.Values[c]+"' >"+e.Values[c]+"</option>")[0]);p.onchange=function(){i()},f.length>1&&g(p,f[1]),C.appendChild(p),l.GetValue=function(){return d.value+";"+p.options[p.selectedIndex].value},l.GetIndex=function(){return p.selectedIndex},t.appendChild(l),t.appendChild(C);break;case 5:case 10:case 6:case 1:var d=F("input","st_FormControl","st_field"+e.ID+"ctrl3");d.onkeydown=function(){i()},d.placeholder=o,l.appendChild(d),d.value=e.DefaultValue,null!=r&&(d.value=r),l.GetValue=function(){return null==d.value?"":d.value},t.appendChild(l)}function g(e,t){for(var n=0;n<e.options.length;n++)if(e.options[n].text==t)return void(e.options[n].selected=!0)}return l.IsValid=function(t){return!e.IsRequired||(""==l.GetValue().trim()?(t&&"MessageBody"!=e.SpecialMapping?(l.firstElementChild.className+=" Error",s.innerHTML=n.format(m.ErrorRequiredSurvey)):t&&(l.firstElementChild.className+=" Error",""==s.innerHTML&&(s.innerHTML=n.format(m.ErrorRequiredSurvey))),!1):(l.firstElementChild.className.indexOf("Error")>0&&t&&(l.firstElementChild.className=l.firstElementChild.className.replace(" Error","")),!0))},l}return a.HideAll=function(e){for(var t in C)C[t].Hide(e)},a.ShowPage=function(e){switch(e){case f.chooseDept:if(null!=m.departments&&2==Object.keys(m.departments).length){for(var n in m.departments)m.departments.propertyIsEnumerable(n)&&0!=n&&P(n);return}if(null==m.departments||0==Object.keys(m.departments).length)return void this.ShowPage(f.offline);break;case f.offline:if(!m.ChosenDepartment.IsOffline)return void this.ShowPage(f.preChat);m.ChosenDepartment.CanSubmitTickets?g(f.offline).AddCustomFields(m.ChosenDepartment.CustomFields,m.ChosenDepartment.NotAvailableCustomMessage):g(f.offline).ShowNotAvailableMessage(m.ChosenDepartment.NotAvailableCustomMessage),u.SetTitle(m.LblSubmitATicket);break;case f.preChat:if(m.ChosenDepartment.IsOffline)return void this.ShowPage(f.offline)}this.HideAll(e),g(e).Show(),t.WidgetStatus=e,"undefined"==typeof isPopup&&N("st_ChatWidgetStatus",e+"|"+(t.IsCollapsed?"1":"0")+"|"+(t.IsPoppedOut?"1":"0")),setTimeout(function(){"function"==typeof sizeWindow&&sizeWindow()},10)},a.ShowChatEnded=function(e,n,s,i){e&&n!=f.waitPage?this.ShowPage(f.survey):(n==f.waitPage&&(g(f.waitPage).ChangeHeaderText(""),s&&t.Collapse()),f.duringChat,a.ShowPage(f.duringChat),g(f.duringChat).ShowChatEnded(i?m.ChosenDepartment.SurveyThankYouTxt:m.ChosenDepartment.PostCustomMessage,m.ChosenDepartment.HasSMTP,m.ChatEndedText),"undefined"!=typeof isPopup&&l.get("api/Chat/ClearStartChatCookie",null,null,"POST"),duringChat.HasSetFirstAgent=!1)},a.HideChatEnded=function(){g(f.duringChat).HideChatEnded()},a.AddSystemMessage=function(e){g(f.duringChat).AddSystemMessage(e)},a.AddMessage=function(e,t,n,s,a,i){g(f.duringChat).AddMessage(e,t,n,s,a,i)},a.UpdateWaitPage=function(e,n){if("undefined"==typeof duringChat||!duringChat||!duringChat.HasSetFirstAgent){var s=g(f.waitPage);t.WidgetStatus!=f.waitPage&&this.ShowPage(f.waitPage),null!=e&&s.ChangeHeaderText(e),null!=n&&s.SetWaitInfoMsg(n)}},a.ShowKBSearchAndUpdateArticles=function(e,t){this.ShowPage(f.kbSearch),g(f.kbSearch).AddArticles(e,t)},a.ClearMessages=function(){g(f.duringChat).ClearMessages()},a.GetCustomFields=function(e){for(var t=g(e).GetCustomFields(),n=[],s=!1,a=0;a<t.length;a++){var i=t[a];if(i.IsValid(!0)){var l={ID:i.ID,DefaultValue:i.GetValue(),SpecialMapping:i.SpecialMapping,DisplayName:i.DisplayName};n.push(l)}else s=!0}return s?null:(g(e).GetErrorBox().innerHTML="",n)},a.GetCustomFieldsString=function(e,t){var n=g(e).GetCustomFields(),s={},a=0;null!=t&&t.length>0&&(a+=t.length,s.TB=t);for(var i=0;i<n.length;i++){var l=n[i];if(l.IsValid(!1)){var o=l.GetValue();if((a+=JSON.stringify(o).length)>4093)return JSON.stringify(s);s[l.ID]=o}}return JSON.stringify(s)},a.ChooseDepartment=function(e,t){if(!e.IsOffline||t){var n=g(f.preChat);null!=n&&(n.SetCustomMessage(e.PreCustomMessage),n.SetCustomFields(e.CustomFields)),t||this.ShowPage(f.preChat),g(f.waitPage).SetWaitInfoMsg(e.WaitMessage)}else this.ShowPage(f.offline)},a.AddSurveyQuestions=function(e,t){var n=C[f.survey];null!=n?n.AddQuestions(e,t):m.SurveyQuestions=e},a.ShowHideAgentStatus=function(e){var t=C[f.duringChat];null!=t&&t.ShowHideAgentStatus(e)},a.ShowLowResloution=function(){e.ShowLowResloution()},a}(m),y=function(){if("undefined"!=typeof isPopup)return null;t.ShouldShowImage=m.IsOnline&&1==m.ConfigSettings._onlineDisplayAs||!m.IsOnline&&1==m.ConfigSettings._offlineDisplayAs;var e=F("div","st_ImageDiv",null,null,t.ShouldShowImage?"":"none"),n=F("a"),s=F("img","st_LogoImage","st_LogoImage");return n.appendChild(s),e.appendChild(n),e.SetData=function(a,i){t.ShouldShowImage=m.IsOnline&&1==m.ConfigSettings._onlineDisplayAs||!m.IsOnline&&1==m.ConfigSettings._offlineDisplayAs,t.ShouldShowImage?this.Show():E(e),null!=a.AnchorTitle&&(n.title=a.AnchorTitle),s.src=a.Image,s.className=s.className.replace(" SVG",""),(a.Image.indexOf(".svg")>-1||a.Image.indexOf("isSvg=true")>-1)&&(s.className=s.className+" SVG")},e.Show=function(){t.ShouldShowImage&&(t.className=t.className+" Image",B(e))},e.Hide=function(){t.IsCollapsed||(t.className=t.className.replace(" Image",""),E(e))},e.onclick=function(){t.IsCollapsed?t.ShowExpanded():t.Collapse()},e}(),_=F("div","st_CopyRight "+W(m.ConfigSettings._bodyColor,!0),"st_CopyRight",m.SmarterTrackLink);if(_.style.backgroundColor=m.ConfigSettings._bodyColor,"undefined"==typeof isPopup){var I=F("div","st_Triangle","st_Triangle"),T=F("div","st_InnerTriangle","st_InnerTriangle");I.appendChild(T),T.style.backgroundColor=m.ConfigSettings._bodyColor}var D=F("div","st_WidgetWrapper");null==m.ConfigSettings._chatStyle||"EmbdChatWidgetDefault.css"==m.ConfigSettings._chatStyle?D.className=D.className+" st_DefaultStyle":D.className=D.className+" st_NotDefaultStyle";var w=F("div","st_TableDiv","st_TableDiv","","none"),M=function(){var e,n=F("div","st_CloseModal","st_CloseModal",null,"none"),s=F("span","st_CloseMessage","st_CloseMessage");n.appendChild(s);var a=F("div","st_CloseModalBtnHolder","st_CloseModalBtnHolder"),i=F("button","st_LeftButton st_BtnSecondary","st_CloseModalNoBtn",m.LblNo);i.onclick=function(){return n.Hide(),!1},a.appendChild(i);var o=F("button","st_LeftButton st_BtnPrimary","st_CloseModalYesBtn",m.LblYes);return o.onclick=function(){return null!=e?(e(),!1):(o.disabled=!0,setTimeout(function(){o.disabled=!1},1e3),l.get("api/Chat/EndChat",{ChatID:m.ClientChatID,InfoGuid:m.InterfaceGuid,LastEventID:m.LastEventID,UserLanguage:m.AutoTranslateLanguage,Status:t.WidgetStatus,DepartmentID:m.ChosenDepartment.DepartmentID},function(){if(t.WidgetStatus==f.waitPage)return c=!0,v.stop(),p=!1,k(),n.Hide(),!1;var e=m.SurveyOffer;t.ShowChatEnded(""!=e&&""!=e&&m.SurveyQuestions.length>0,t.WidgetStatus,!0),v.stop(),p=!1},"POST"),!1)},a.appendChild(o),n.appendChild(a),n.Show=function(t,a){s.innerHTML=t,n.style.display="",e=a},n.Hide=function(){n.style.display="none"},n}();w.appendChild(M);var b=!1,H=!1;m.WidgetPosition.indexOf("B")>-1&&(w.appendChild(g),null!=y&&(y.className=y.className+" Bottom"),u.className=u.className+" Bottom",w.appendChild(_),"undefined"==typeof isPopup&&(w.appendChild(I),I.collapseName=" CollapseBottom"),D.appendChild(w),null!=y&&D.appendChild(y),"undefined"==typeof isPopup&&D.appendChild(u));m.WidgetPosition.indexOf("L")>-1?null!=y&&(y.className=y.className+" Left"):(b=!0,D.className=D.className+" Right",w.className=w.className+" Right",u.className=u.className+" Right",g.className=g.className+" Right",null!=I&&(I.className=I.className+" Right"),null!=_&&(_.className=_.className+" Right"));-1==m.WidgetPosition.indexOf("B")&&(H=!0,"undefined"==typeof isPopup&&D.appendChild(u),w.className=w.className+" Top",u.className=u.className+" Top",null!=I&&(I.className=I.className+" Top",I.collapseName=" CollapseTop"),null!=y&&(y.className=y.className+" Top",D.appendChild(y)),null!=I&&w.appendChild(I),w.appendChild(g),null!=_&&w.appendChild(_),D.appendChild(w));H&&t.appendChild(D);var x,O=F("div","st_OneTimeMessagePlaceHolder",null,null,"none");t.appendChild(O),H||t.appendChild(D);function P(e,t,s,a,i){null==m.ChosenDepartment||m.ChosenDepartment.DepartmentID!=e?l.get("api/Chat/ChooseDepartment/"+e,"",function(l){null!=l&&(l.Error&&null!=t?null!=t&&(t.innerHTML=n.format(l.ErrorMessage)):(m.ChosenDepartment=l,m.ChosenDepartment.DepartmentID=e,null!=i&&i(),(null==a||a)&&g.ChooseDepartment(l,s)))},"POST"):g.ChooseDepartment(m.ChosenDepartment,s)}function W(e,t){if(null==e)return"";var n=parseInt(e.substr(1,2),16),s=parseInt(e.substr(3,2),16),a=parseInt(e.substr(5,2),16),i=(299*n+587*s+114*a)/1e3;return t?i>=128?"st_Black":"st_White":i>=128?"st_Gray":"st_White"}function F(e,t,n,s,a,i){var l=document.createElement(e);return"input"!=e&&"textarea"!=e||(l.onfocus=function(e){e.preventDefault();var t=window.pageYOffset||document.documentElement.scollTop;return setTimeout(function(){window.scrollTo(0,t)},10),!1},l.onfocusin=function(e){e.preventDefault();var t=window.pageYOffset||document.documentElement.scollTop;return setTimeout(function(){window.scrollTo(0,t)},10),!1}),null!=t&&(l.className=t),null!=n&&(l.id=n),null!=s&&(l.innerHTML=s),null!=a&&(l.style.display=a),null!=i&&(l.onclick=i),l}return t.Body=g,t.ShowChatEnded=function(e,n,s){e&&"undefined"!=typeof isTranscript&&"True"==isTranscript&&(e=!1),c=!0,t.Body.ShowHideAgentStatus(!1),M.Hide(),this.ShowingChatEnded=!0,g.ShowChatEnded(e,n,s)},t.HideChatEnded=function(){D.className=D.className.replace("st_DefaultStyle",""),D.className=D.className.replace("st_NotDefaultStyle",""),null==m.ConfigSettings._chatStyle||"EmbdChatWidgetDefault.css"==m.ConfigSettings._chatStyle?D.className=D.className+" st_DefaultStyle":D.className=D.className+" st_NotDefaultStyle",this.ShowingChatEnded=!1,g.HideChatEnded()},t.ShowExpanded=function(e){if(!h||e){if(!t.isSelectingDepartment){if(!t.HasShownExpanded&&m.ChosenDepartment&&null!=m.ChosenDepartment.DepartmentID){var n=m.ChosenDepartment.DepartmentID;return m.ChosenDepartment=null,t.isSelectingDepartment=!0,t.HasShownExpanded=!0,void P(n,null,e,!1,function(){t.isSelectingDepartment=!1,t.ShowExpanded(e)})}if(this.isShowingOneTimeMessage)return this.HideOneTimeMessage(),void setTimeout(function(){t.ShowExpanded(e)},200);y&&y.className.indexOf("Animated")>0&&(y.className=y.className.replace(" st_LogoImageAnimated","")),t.IsCollapsed=!1,u.ShowExpanded(),(""==this.WidgetStatus||isNaN(this.WidgetStatus))&&(this.WidgetStatus=f.chooseDept),g.ShowPage(this.WidgetStatus),null!=T&&(T.className=T.className.replace(I.collapseName,"")),null!=x&&(clearTimeout(x),x=null),null!=w&&(w.style.display="",x=setTimeout(function(){w.className=w.className.replace(" st_CollapseScale","")},10))}}else g.ShowLowResloution()},t.Collapse=function(e){t.IsCollapsed=!0,e&&(setTimeout(t.Body.ClearMessages,1e3),m.ClientChatID=-1,m.LastAgentID=-1,m.LastEventID=-1),"undefined"==typeof isPopup&&(T.className=T.className.replace(I.collapseName,""),T.className=T.className+I.collapseName,w.className=w.className.replace(" st_CollapseScale",""),w.className=w.className+" st_CollapseScale",null!=x&&(clearTimeout(x),x=null),x=setTimeout(function(){w.style.display="none"},300),N("st_ChatWidgetStatus",t.WidgetStatus+"|1|"+(this.IsPoppedOut?"1":"0"))),t.WidgetStatus==f.duringChat&&t.Body.ShowPage(t.WidgetStatus)},t.SetOnlineOffline=function(e){var n=e?{AnchorTitle:m.ConfigSettings._onlineLinkTitle,Title:m.ConfigSettings._onlineText,Image:m.ConfigSettings._onlineImageHref,HeaderColor:m.ConfigSettings._headerColorOnline}:{AnchorTitle:m.ConfigSettings._offlineLinkTitle,Title:m.ConfigSettings._offlineText,Image:m.ConfigSettings._offlineImageHref,HeaderColor:m.ConfigSettings._headerColorOffline};u.SetData(n,e),null!=y&&y.SetData(n,e),function(e,n,s,a,i){var l=a?m.ConfigSettings._firstMessageTextOnline:m.ConfigSettings._firstMessageTextOffline,o=a?m.ConfigSettings.ShowOneTimeMessageOnline:m.ConfigSettings.ShowOneTimeMessageOffline;if(null!=l&&""!=l&&o&&t.IsCollapsed){i.style.display="";var r=F("div","st_OneTimeMessageHolder","st_OneTimeMessageHolder");r.onclick=function(){t&&t.ShowExpanded()};var d=F("div","st_OneTimeMessage st_FadeOut","st_OneTimeMessage",null,"none");d.innerHTML=l;var u,c=F("div","st_Triangle st_FadeOut","st_OneTimeTriangle",null,"none"),p=F("div","st_InnerTriangle","st_OneTimeInnerTriangle");c.appendChild(p),n&&(r.className=r.className+" Right",c.className=c.className+" Right",d.className=d.className+" Right"),s?(r.appendChild(c),r.appendChild(d),c.className=c.className+" Top",d.className=d.className+" Top",i.appendChild(F("br")),i.appendChild(r)):(r.appendChild(d),r.appendChild(c),i.appendChild(r),i.appendChild(F("br"))),setTimeout(function(){B(d),B(c),u=setTimeout(function(){d.FadeOut()},1e4)},1e3),d.FadeOut=function(){E(d),E(c),setTimeout(function(){t.isShowingOneTimeMessage&&(t.isShowingOneTimeMessage=!1,i.removeChild(r),i.style.display="none",a?m.ConfigSettings._firstMessageTextOnline="":m.ConfigSettings._firstMessageTextOffline="",e&&e())},200)},d.onclick=function(){this.FadeOut()},t.isShowingOneTimeMessage=!0,t.HideOneTimeMessage=function(){null!=u&&(clearTimeout(u),u=null,d.FadeOut())}}else e()}(function(){w.className=w.className.replace(" st_Table",""),w.className=w.className+" st_Table"},b,H,e,O)},t.CheckIfOnline=function(){c&&!p&&-1==m.ClientChatID&&l.get("api/Chat/CheckIfOnline/"+r,null,function(e){var n=m.IsOnline!=e;m.IsOnline=e,n&&t.SetOnlineOffline(e)},"GET"),null!=a&&(clearTimeout(a),a=null),a=setTimeout(t.CheckIfOnline,1e3*m.ConfigSettings._refreshSeconds)},t.IsTranscript=function(){return 5==t.WidgetStatus&&c},t}();u.appendChild(g);var v=$.hubConnection(),S=v.createHubProxy("stClientChatHub");S.on("broadcastMessages",y),S.on("chatEnded",_),S.on("history",I),S.on("message",T),S.on("setAgent",D),S.on("updateTyping",w),S.on("waitMessage",M),v.reconnecting(function(){-1===m.ClientChatID||c||g.Body.AddSystemMessage(m.PageStringErrorConnection),!0}),v.reconnected(b),v.disconnected(function(){p=!1,-1==m.ClientChatID||c||(g.Body.AddSystemMessage(m.PageStringErrorConnection),setTimeout(function(){v.state!==$.signalR.connectionState.connected?v.start().done(b):b()},15e3))}),$(window).bind("unload",function(){S.off("broadcastMessages",y),S.off("chatEnded",_),S.off("history",I),S.off("message",T),S.off("setAgent",D),S.off("updateTyping",w),S.off("waitMessage",M)}),st_Widget.InviteToLiveChat=function(e,t,n,s,a,i){var l=g.IsCollapsed;g.IsCollapsed&&g.ShowExpanded(!0),g.Body.ChatInvite={WasCollapsed:l,PrevStatus:g.WidgetStatus==f.chatInvite?f.chooseDept:g.WidgetStatus,DepartmentID:n,GroupID:s},i&&g.Body.ShowPage(f.chatInvite),g.Body.SetInviteData(e,t,a)},"undefined"!=typeof isTranscript&&"True"==isTranscript&&(g.WidgetStatus=f.duringChat),-1==m.ClientChatID&&g.WidgetStatus>3&&g.WidgetStatus!=f.offline&&g.WidgetStatus!=f.chatInvite||(g.WidgetStatus==f.preChat||g.WidgetStatus==f.offline)&&null==m.ChosenDepartment&&-1==m.ClientChatID||g.WidgetStatus==f.chatInvite&&null==m.ChatInvite?g.WidgetStatus=f.chooseDept:-1!=m.ClientChatID&&g.WidgetStatus!=f.waitPage?g.WidgetStatus=f.duringChat:g.WidgetStatus==f.offline&&"undefined"!=typeof isPopup?g.WidgetStatus=f.chooseDept:g.WidgetStatus==f.kbSearch&&null!=m.ChosenDepartment?(m.ChosenDepartment.IsOffline?g.WidgetStatus=f.offline:g.WidgetStatus=f.preChat,g.SelectKbSearch=!0):null!=m.SavedCustomPreChatFields&&g.WidgetStatus!=f.preChat&&g.WidgetStatus!=f.kbSearch&&null!=m.ChosenDepartment&&(g.WidgetStatus=f.preChat),"undefined"==typeof isPopup&&(navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Silk/i))&&(h=!0),"undefined"==typeof isPopup&&navigator.userAgent.match(/Android/i)&&navigator.userAgent.match(/mobile/i)&&(h=!0),"undefined"!=typeof isPopup||!g.IsCollapsed&&!h?g.ShowExpanded():g.Collapse(),g.SetOnlineOffline(m.IsOnline),setTimeout(g.CheckIfOnline,1e3*m.ConfigSettings._refreshSeconds),"undefined"!=typeof isPopup&&(window.onunload=function(e){window.opener.postMessage("chatMessage|"+g.WidgetStatus+"|"+m.ClientChatID+"|"+c,"*")}),g.setVariables=function(e,t,n){if(-1==m.ClientChatID||m.ClientChatID==n){c=e;var s=m.LastEventID;l.get("api/Chat/Intialize/"+o+"/"+r+"/"+(""==i?"null":i),{},function(e){if(null!=e)return(m=e).LastEventID=s,p=!1,m.ClientChatID=n,c&&t!=f.survey?k():(g.ShowExpanded(),g.Body.ShowPage(t)),!1},"GET")}},window.addEventListener("message",function(e){if("function"!=typeof e.data.split)return;var t=e.data.split("|");if(t.length>4||"chatMessage"!=t[0])return;g.IsPoppedOut=!1,g.style.display="",g.setVariables("true"==t[3],parseInt(t[1]),parseInt(t[2]))},!1),null!=m.ChatInvite&&st_Widget.InviteToLiveChat(m.ChatInvite.Message,m.textAreaPlaceHolderText,m.ChatInvite.DepartmentID,m.ChatInvite.GroupID,m.ChatInvite.Timeout,!0)}}function y(e){A(e)}function _(e){if(!c){var t=m.SurveyOffer;g.ShowChatEnded(""!=t&&null!=t&&m.SurveyQuestions.length>0,g.WidgetStatus,!1),m.lastEventID=-1,c=!0,v.stop(),p=!1}}function I(e,t){$.each(t.messages,function(e,t){t.messageId<m.LastEventID||("FromSystem"===t.senderType?g.Body.AddSystemMessage(t.text):g.Body.AddMessage(t.text,t.translation,t.displayName,"FromUser"===t.senderType,t.uniqueId?t.uniqueId:t.messageId,!0))})}function T(e,t){t.messageId<m.LastEventID||("FromSystem"===t.senderType?g.Body.AddSystemMessage(t.text):g.Body.AddMessage(t.text,t.translation,t.displayName,"FromUser"===t.senderType,t.uniqueId?t.uniqueId:t.messageId,!1))}function D(e,t){m.LastAgentID!==e&&(g.WidgetStatus!==f.waitPage&&g.WidgetStatus===f.duringChat||g.Body.ShowPage(f.duringChat)),g.Body.SetTypingMessage(t),m.LastAgentID=e}function w(e,n,s,a,i){s||(n?g.Body.ShowHideAgentStatus(!0):g.Body.ShowHideAgentStatus(!1),d&&clearTimeout(d),n&&(d=setTimeout(function(){g.Body.ShowHideAgentStatus(!1),d=null},t)))}function M(e,t){g.Body.UpdateWaitPage(e,t)}function b(){g.WidgetStatus!=f.waitPage&&g.Body.AddSystemMessage(m.PageStringConnectionRestored),L()}function k(){g.Collapse(!0),g.ShowingChatEnded&&g.HideChatEnded(),l.get("api/Chat/ClearStartChatCookie",null,null,"POST"),N("st_ChatWidgetStatus","|1|"+(g.IsPoppedOut?"1":"0")),g.WidgetStatus="|1",m.ChosenDepartment=null,m.ChosenDepartment=null,m.SavedCustomTicketFields=null,m.SavedCustomPreChatFields=null}function N(e,t){var n="https:"==window.location.protocol;if("undefined"==typeof isTranscript||"True"!=isTranscript){var s=new Date;s.setTime(s.getTime()+36e5),document.cookie=e+"="+t+(n?";secure":"")+"; expires="+s.toGMTString()+"; path=/"}}function A(e,t){if(e)for(var n in e){var s=e[n];switch(m.LastEventID<s.LastEventID&&(m.LastEventID=s.LastEventID),s.ActionCode){case"StartChat":m.ClientChatID=s.MsgID,m.SurveyOffer=s.MsgBody,void 0!==g.Body.ChangeChatID&&g.Body.ChangeChatID(m.ClientChatID),m.ChatEndedText=s.ChatNumber,m.UserName=s.MsgName,c=!1,s.Questions.length>0&&g.Body.AddSurveyQuestions(s.Questions,m.ChosenDepartment.SurveyWelcomeTxt);break;case"IsTyping":w(m.ClientChatId,0,s.isTyping);break;case"AddMessage":if(s.LastEventID<m.LastEventID)break;g.Body.AddMessage(s.MsgBody,s.Translation,s.MsgName,s.IsUser,s.MsgID,t);break;case"ChatEnded":_();break;case"SetAgent":D(s.MsgBody,s.MsgName);break;case"AddSystemMessage":g.Body.AddSystemMessage(s.MsgBody);break;case"UpdateWaitHeader":g.Body.UpdateWaitPage(s.MsgBody,s.MsgName);break;case"KBSearch":g.Body.ShowKBSearchAndUpdateArticles(s.Articles);break;case"KBSearchTickets":g.Body.ShowKBSearchAndUpdateArticles(s.Articles,!0);break;case"ticketSubmissionError":g.Body.ShowTicketSubmitConfirmation(null,s.MsgBody);break;case"ticketSubmission":g.Body.ShowTicketSubmitConfirmation(s.MsgBody,null)}}}function B(e){e.style.display="",null!=e.showHideEvent&&(clearTimeout(e.showHideEvent),e.showHideEvent=null),e.showHideEvent=setTimeout(function(){e.className=e.className.replace("st_FadeOut",""),e.className=e.className.replace("st_FadeIn",""),e.className=e.className+" st_FadeIn"},100)}function E(e){null!=e.showHideEvent&&(clearTimeout(e.showHideEvent),e.showHideEvent=null),e.showHideEvent=setTimeout(function(){e.style.display="none"},200),e.className=e.className.replace("st_FadeIn",""),e.className=e.className.replace("st_FadeOut",""),e.className=e.className+" st_FadeOut"}function L(e){-1==m.ClientChatID||c||(p?S.invoke("userRegisterConnection",m.ClientChatID).done(function(){p=!0,null!==e&&e()}).fail(function(){setTimeout(function(){p=!1,L(e)},1e3)}):S.invoke("userLogin",m.ClientChatID).done(function(){p=!0,null!==e&&e()}).fail(function(){setTimeout(function(){p=!1,L(e)},1e3)}))}}function C(e){for(var t=e+"=",n=document.cookie.split(";"),s=0;s<n.length;s++){for(var a=n[s];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null}p.timeoutEvent=setTimeout(h,1e4),p.onload=function(){null!=p.timeoutEvent&&h()},l.get("api/Chat/Intialize/"+o+"/"+r+"/"+(""==i?"null":i),{},function(e){return null==p.timeoutEvent?f(e):c=e,!1},"GET")}function st_InviteToLiveChat(e,t,n,s,a){st_Widget.InviteToLiveChat(e,t,n,s,a,!0)}
//# sourceMappingURL=EmbeddedClientChat.js.map
